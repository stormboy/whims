<html>
<head>
	<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
	<script src="js/biwascheme-min.js" type="text/javascript"></script>
	
	<script type="text/javascript">
	// Scheme parsing test
	$(document).ready(function() {
		var messagesSelector = "#messages";

		function displayObject(o) {
			if (BiwaScheme.isSymbol(o)) {
				$(messagesSelector).append("<p>parsed object: " + o + " is a symbol</p>");
			}
			else if (BiwaScheme.isList(o)) {
				displayList(o);
			}
			else if (BiwaScheme.isPair(o)) {
				$(messagesSelector).append("<p>parsed object: " + o + " is a pair</p>");
			}
			else {
				$(messagesSelector).append("<p>parsed object: " + o + " is a " + typeof(o) + "</p>");
			}
		}
		function displayList(list) {
			var msg = "";
			var arr = list.to_array();
			for (var i=0; i<arr.length; i++) {
				msg += arr[i] + " ";
			}
			$(messagesSelector).append("<p>parsed object: " + list + " is a list: " + msg + "</p>");
			
			// TODO check first object in the list
			for (var i=0; i<arr.length; i++) {
				displayObject(arr[i]);
			}
		}
		
		var expression = "(value #t (1 2 \"3\") (a . 3) 10:abcdefghij)";
		$(messagesSelector).append("<p>expression: " + expression + "</p>");
		
 		var parser = new BiwaScheme.Parser(expression);
		while ((obj = parser.getObject()) != BiwaScheme.Parser.EOS) {
			displayObject(obj);
		}
		
		json = { value : true };
		str = BiwaScheme.json2sexp(json);
		$(messagesSelector).append("<p>s-expression: " + str + "</p>");
	});
	</script>
</head>

<body>
	<h1>For testing S-Expression parsing</h1>
	<h2>Marshal and unmarshal S-Expressions to various Facet Messages</h2>
	<p>Currently, the BiwaScheme parser is used.</p>
	<p>TODO: iterate through test messages of every registered Facet type to test.</p>
 
 	<div id="messageContainer">
		<div id="messages"></div>
	</div>
	
</body>
</html>